<!doctype html>
<html lang="en">
  <head>
    <script>
      // Immediately set the theme before the page renders
      (function () {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
          document.documentElement.setAttribute('data-theme', savedTheme);
        } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
          document.documentElement.setAttribute('data-theme', 'dark');
        }
      })();
    </script>
    <meta charset="UTF-8">
    <meta name="author" content="Uzair Shamim">

    {% if tags %}
      <meta name="description" content="{{ page.excerpt | truncate: 450, '...' | replace: '"', "'" }}">
    {% else %}
      <meta
        name="description"
        content="Uzair Shamim is a software developer passionate about HTML5, Javascript and .NET."
      >
    {% endif %}
    {% if tags %}
      <meta name="tags" content="{% for tag in tags %}{{ tag }}{% if forloop.last == false %}, {% endif %}{% endfor %}">
    {% endif %}

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap"
    >
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans&display=swap">
    <link rel="icon" type="image/x-icon" href="/img/favicon.ico">
    <title>{{ 'Pureooze - ' | append: title }}</title>
    {%- css %}
    {% include 'css/style.css' %}
    {% endcss %}
    {%- css %}
    {% include 'css/blog.css' %}
    {% endcss %}
    {%- css %}
    {% include 'css/prism-diff.css' %}
    {% endcss %}
    <style>
      {% getBundle "css" %}
    </style>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XLDBGRBD5M"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());

      gtag('config', 'G-XLDBGRBD5M');
    </script>
    <script>
      // Theme toggle functionality
      function initializeTheme() {
        // Check for saved theme preference or use system preference
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
          document.documentElement.setAttribute('data-theme', savedTheme);
          updateThemeIcon(savedTheme);
        } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
          document.documentElement.setAttribute('data-theme', 'dark');
          updateThemeIcon('dark');
        }
      }

      function updateThemeIcon(theme) {
        const toggleText = document.querySelector('.theme-toggle-text');
        if (toggleText) {
          toggleText.textContent = theme === 'dark' ? 'ðŸŒ™' : 'ðŸŒž';
        }
      }

      function toggleTheme() {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

        document.documentElement.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
        updateThemeIcon(newTheme);
      }

      // Add event listener to theme toggle button
      document.addEventListener('DOMContentLoaded', () => {
        initializeTheme();
        const themeToggle = document.querySelector('.theme-toggle');
        if (themeToggle) {
          themeToggle.addEventListener('click', toggleTheme);
        }
      });
    </script>
  </head>
  <body>
    <div class="navbar">
      <div class="navbar-left">
        <a class="navbar-link" href="/">Home</a>
        <a class="navbar-link" href="/blog">Blog</a>
        <a class="navbar-link" href="/random">Random</a>
      </div>
      <div class="navbar-right">
        <button class="theme-toggle" aria-label="Toggle theme">
          <span class="theme-toggle-text">ðŸŒž</span>
        </button>
        <a class="navbar-icon-link" href="https://github.com/pureooze/pureooze.github.io">
          {% assign iconPath = 'img/' | append: 'github-logo.webp' %}
          {% image iconPath "" "navbar-icon" %}
        </a>
      </div>
    </div>
    {{ content }}
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // Find all code elements within paragraphs and list items
        const codeElements = document.querySelectorAll('p>code, li>code');

        codeElements.forEach((code) => {
          code.addEventListener('click', async function () {
            // Get the text content
            const text = this.textContent;

            try {
              // Try to copy the text
              await navigator.clipboard.writeText(text);

              // Add a class to show "Copied!"
              this.classList.add('copied');

              // Reset after 2 seconds
              setTimeout(() => {
                this.classList.remove('copied');
              }, 2000);
            } catch (err) {
              console.error('Failed to copy text: ', err);
              this.classList.add('copy-failed');
              setTimeout(() => {
                this.classList.remove('copy-failed');
              }, 2000);
            }
          });
        });
      });
    </script>
  </body>
</html>
